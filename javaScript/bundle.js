(()=>{var e,t,n,l,o={4213:function(e,t,n){var l,o;void 0===(o="function"==typeof(l=function(){"use strict";function t(e,t,n){var l=new XMLHttpRequest;l.open("GET",e),l.responseType="blob",l.onload=function(){s(l.response,t,n)},l.onerror=function(){console.error("could not download file")},l.send()}function l(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function o(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var a="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof n.g&&n.g.global===n.g?n.g:void 0,i=a.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=a.saveAs||("object"!=typeof window||window!==a?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(e,n,i){var s=a.URL||a.webkitURL,r=document.createElement("a");n=n||e.name||"download",r.download=n,r.rel="noopener","string"==typeof e?(r.href=e,r.origin===location.origin?o(r):l(r.href)?t(e,n,i):o(r,r.target="_blank")):(r.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(r.href)}),4e4),setTimeout((function(){o(r)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,n,a){if(n=n||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(function(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}(e,a),n);else if(l(e))t(e,n,a);else{var i=document.createElement("a");i.href=e,i.target="_blank",setTimeout((function(){o(i)}))}}:function(e,n,l,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof e)return t(e,n,l);var s="application/octet-stream"===e.type,r=/constructor/i.test(a.HTMLElement)||a.safari,d=/CriOS\/[\d]+/.test(navigator.userAgent);if((d||s&&r||i)&&"undefined"!=typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=d?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=e:location=e,o=null},c.readAsDataURL(e)}else{var u=a.URL||a.webkitURL,h=u.createObjectURL(e);o?o.location=h:location.href=h,o=null,setTimeout((function(){u.revokeObjectURL(h)}),4e4)}});a.saveAs=s.saveAs=s,e.exports=s})?l.apply(t,[]):l)||(e.exports=o)}},a={};function i(e){var t=a[e];if(void 0!==t)return t.exports;var n=a[e]={exports:{}};return o[e].call(n.exports,n,n.exports,i),n.exports}i.m=o,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,i.t=function(n,l){if(1&l&&(n=this(n)),8&l)return n;if("object"==typeof n&&n){if(4&l&&n.__esModule)return n;if(16&l&&"function"==typeof n.then)return n}var o=Object.create(null);i.r(o);var a={};e=e||[null,t({}),t([]),t(t)];for(var s=2&l&&n;("object"==typeof s||"function"==typeof s)&&!~e.indexOf(s);s=t(s))Object.getOwnPropertyNames(s).forEach((e=>a[e]=()=>n[e]));return a.default=()=>n,i.d(o,a),o},i.d=(e,t)=>{for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.f={},i.e=e=>Promise.all(Object.keys(i.f).reduce(((t,n)=>(i.f[n](e,t),t)),[])),i.u=e=>e+".bundle.js",i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n={},l="BAM-CDN:",i.l=(e,t,o,a)=>{if(n[e])n[e].push(t);else{var s,r;if(void 0!==o)for(var d=document.getElementsByTagName("script"),c=0;c<d.length;c++){var u=d[c];if(u.getAttribute("src")==e||u.getAttribute("data-webpack")==l+o){s=u;break}}s||(r=!0,(s=document.createElement("script")).charset="utf-8",i.nc&&s.setAttribute("nonce",i.nc),s.setAttribute("data-webpack",l+o),s.src=e),n[e]=[t];var h=(t,l)=>{s.onerror=s.onload=null,clearTimeout(p);var o=n[e];if(delete n[e],s.parentNode&&s.parentNode.removeChild(s),o&&o.forEach((e=>e(l))),t)return t(l)},p=setTimeout(h.bind(null,void 0,{type:"timeout",target:s}),12e4);s.onerror=h.bind(null,s.onerror),s.onload=h.bind(null,s.onload),r&&document.head.appendChild(s)}},i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;i.g.importScripts&&(e=i.g.location+"");var t=i.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var n=t.getElementsByTagName("script");if(n.length)for(var l=n.length-1;l>-1&&(!e||!/^http(s?):/.test(e));)e=n[l--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),i.p=e})(),(()=>{var e={792:0};i.f.j=(t,n)=>{var l=i.o(e,t)?e[t]:void 0;if(0!==l)if(l)n.push(l[2]);else{var o=new Promise(((n,o)=>l=e[t]=[n,o]));n.push(l[2]=o);var a=i.p+i.u(t),s=new Error;i.l(a,(n=>{if(i.o(e,t)&&(0!==(l=e[t])&&(e[t]=void 0),l)){var o=n&&("load"===n.type?"missing":n.type),a=n&&n.target&&n.target.src;s.message="Loading chunk "+t+" failed.\n("+o+": "+a+")",s.name="ChunkLoadError",s.type=o,s.request=a,l[1](s)}}),"chunk-"+t,t)}};var t=(t,n)=>{var l,o,[a,s,r]=n,d=0;if(a.some((t=>0!==e[t]))){for(l in s)i.o(s,l)&&(i.m[l]=s[l]);r&&r(i)}for(t&&t(n);d<a.length;d++)o=a[d],i.o(e,o)&&e[o]&&e[o][0](),e[o]=0},n=self.webpackChunkBAM_CDN=self.webpackChunkBAM_CDN||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})();var s={};(()=>{"use strict";i.d(s,{B:()=>I});class e{constructor(e,t){this.lastSortedColumn=null,this.table=e,this.tableId=t,this.init()}init(){this.table.find("tr").each(((e,t)=>{this.handleTableHeaders($(t))}))}handleTableHeaders(e){let t=0;e.find("th").each(((e,n)=>{const l=$(n),o=l.find(".table-header-text"),a=l.find(".table-header-text").text().trim(),i=l.find(".sort").length>0;parseInt(String(l.attr("colspan")))>1||""===a||!i?(o.css("cursor","default"),t+=parseInt(String(l.attr("colspan")))):(this.makeColumnSortable(l,a,t),t++),l.find(".sort").on("click",(()=>{"default"!==l.css("cursor")&&this.handleSortClick(l,l.data("column-index"))}))}))}makeColumnSortable(e,t,n){e.find(".header-wrapper").wrapInner(`<span title="Sorteer op ${t}" class="table-header-text"></span>`),e.attr("data-column-index",n.toString())}handleSortClick(e,t){let n="ascending"===e.data("sort")?"descending":"ascending";const l=this.table.children("tbody").children("tr").get();this.lastSortedColumn!==e&&(n="ascending"),e.data("sort",n),this.lastSortedColumn&&this.hideCarrot($(this.lastSortedColumn),"");const o=this.sortRows(l,t,n);this.hideCarrot(e,n),this.table.children("tbody").append(o),this.lastSortedColumn=e}sortRows(e,t,n){const l=e.sort(((e,n)=>{const l=$(e).children("td").eq(t).text(),o=$(n).children("td").eq(t).text(),a=parseFloat(l),i=parseFloat(o),s=!isNaN(a),r=!isNaN(i);return s&&r?a-i:s?-1:r?1:l.localeCompare(o,void 0,{numeric:!0})}));return"descending"===n&&l.reverse(),l}hideCarrot(e,t){const n=e.find(".sort i").first(),l=e.find(".sort i").last();"ascending"===t?(n.css("visibility","visible"),l.css("visibility","hidden")):"descending"===t?(n.css("visibility","hidden"),l.css("visibility","visible")):(n.css("visibility","visible"),l.css("visibility","visible"))}}class t{constructor(e,t=1,n,l,o){this.columnIndexes=[],this.text=e,this.colspan=t,this.columnIndexes=n,this.id=l,this.fullHeaderName=o}}class n{constructor(e,t=null,n=null,l=!0,o=null){this.validation_color=null,this.validation_rgb=null,this.visible=!0,this.link=null,this.text=e,this.validation_color=t,this.validation_rgb=n,this.visible=l,this.link=o}}var l=function(e,t,n,l){return new(n||(n=Promise))((function(o,a){function i(e){try{r(l.next(e))}catch(e){a(e)}}function s(e){try{r(l.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}r((l=l.apply(e,t||[])).next())}))};class o{static createWorkbook(){return l(this,void 0,void 0,(function*(){return new((yield i.e(974).then(i.t.bind(i,4974,23))).Workbook)}))}static createZip(){return l(this,void 0,void 0,(function*(){return new(0,(yield i.e(710).then(i.t.bind(i,1710,23))).default)}))}static createPdfInstance(e){return l(this,void 0,void 0,(function*(){const{jsPDF:t}=yield i.e(781).then(i.bind(i,8781)),{applyPlugin:n}=yield i.e(708).then(i.bind(i,5708));n(t);const l=yield this.loadFont();return t.API&&t.API.events.push(["addFonts",function(){this.addFileToVFS("NotoSans-Regular-normal.ttf",l),this.addFont("NotoSans-Regular-normal.ttf","NotoSans-Regular","normal")}]),new t("landscape","pt",e)}))}static loadFont(){return l(this,void 0,void 0,(function*(){const{font:e}=yield i.e(505).then(i.bind(i,4505));return e}))}static addHeaderRow(e,n,l,o){let a=n;l||(a=[[]],o.forEach((e=>{a[0].push(new t(e.text,1,[e.columnIndex],e.columnIndex,e.text))}))),a.forEach(((t,n)=>{const o=e.addRow(t.map((e=>e.text)));t.forEach(((t,l)=>{t.colspan>1&&e.mergeCells(n+1,l+1,n+1,l+t.colspan)})),l&&o.eachCell((e=>{e.font={bold:!0,color:{argb:"FFFFFFFF"}},e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FF0DB02B"}},e.border={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"}},e.alignment={horizontal:"center",vertical:"middle"}}))}))}static addBodyRows(e,t,n,l,o,a){t.forEach(((t,n)=>{l&&t.every((e=>!e.visible))||e.addRow(t.map((e=>{const t=e.text;return isNaN(Number(t))?t:Number(t)}))).eachCell(((e,l)=>{const i=t[l-1];i&&(isNaN(Number(e.value))?e.alignment={wrapText:!0}:e.numFmt="0.00",i.link?(e.value={text:i.text,hyperlink:i.link},e.font={underline:!0,color:{argb:"FF0000FF"}}):e.value=i.text,a&&i.validation_color?e.fill={type:"pattern",pattern:"solid",fgColor:{argb:i.validation_color}}:o&&(e.fill={type:"pattern",pattern:"solid",fgColor:{argb:n%2==0?"E5E5E5":"F2F2F2"}}))}))}))}static autoSizeColumns(e){e&&e.columns&&e.columns.forEach((e=>{let t=0;e.eachCell((e=>{var n;const l=(null===(n=e.value)||void 0===n?void 0:n.toString().length)||0;t=Math.max(t,l)})),e.width=Math.max(t+2,10)}))}static executeDownload(e,t){return l(this,void 0,void 0,(function*(){if(!e||!e.xlsx)return;const n=yield e.xlsx.writeBuffer();if(!URL||!URL.createObjectURL)return;const l=new Blob([n],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),a=URL.createObjectURL(l),i=document.createElement("a");i.href=a,i.download=`${o.parseFileName(t)}.xlsx`,i.click(),URL.revokeObjectURL(a)}))}static calculateMinTableWidth(e,t=200,n=3e3){if(!e)return t;const l=$("<div></div>");l.css({position:"absolute",visibility:"hidden",overflow:"auto",border:"1px solid red"}),l.append(e.clone(!0)),$("body").append(l);let o=t,a=n,i=n;for(;o<=a;){const e=Math.floor((o+a)/2);l.css("width",`${e}px`),l[0].scrollWidth>e?o=e+1:(i=e,a=e-1)}return l.remove(),i}static generatePdfFile(e){return l(this,arguments,void 0,(function*(e,t=null){let n="a4";this.calculateMinTableWidth(e.tableHandler.table)>1e3&&(n="a3"),t||(t=yield this.createPdfInstance(n)),t.addFileToVFS("NotoSans-Regular-normal.ttf",yield this.loadFont()),t.addFont("NotoSans-Regular-normal.ttf","NotoSans","normal"),t.setFont("NotoSans");const l=e.tableHandler.tableHeaders,o=e.tableHandler.tableBody;let a=this.getHeadStyle(e),i=this.getBodyStyle(e);const s=this.extractHeaderData(l,e),r=this.extractBodyData(o,e);return this.createPdf(t,s,r,a,i,20),t}))}static generatePdf(e){return l(this,arguments,void 0,(function*(e,t=""){const n=yield this.generatePdfFile(e);""===t&&(t=e.tableHandler.tableName),n.save(`${o.parseFileName(t)}.pdf`)}))}static getHeadStyle(e){return e.useStyling?{fillColor:[13,176,43],textColor:[255,255,255],fontStyle:"bold",lineWidth:.5,lineColor:[0,0,0],halign:"center"}:{fillColor:[255,255,255],textColor:[0,0,0],lineWidth:.5,lineColor:[0,0,0]}}static getBodyStyle(e){return e.useStyling?{fillColor:[255,255,255],textColor:[0,0,0],halign:"center"}:{fillColor:[255,255,255],textColor:[0,0,0],lineWidth:.5,lineColor:[0,0,0]}}static extractHeaderData(e,n){n.useStyling||(e=[[]],n.tableHandler.fullHeaderNames.forEach((n=>{e[0].push(new t(n.text,1,[n.columnIndex],n.columnIndex,n.text))})));let l=[];return e.forEach((e=>{const t=[];e.forEach((e=>{if(0===e.colspan)return;const n=e.text,l=e.colspan;t.push({content:n,colSpan:l})})),l.push(t)})),l}static extractBodyData(e,t){let n=[];return e.forEach((e=>{const l=[];e.forEach((e=>{if(!e.visible&&t.useFilter)return;const n=e.text,o=t.showValidations?e.validation_rgb:null;l.push({content:n,backgroundColor:o})})),l.length>0&&n.push(l)})),n}static createPdf(e,t,n,l,o,a=20){e.autoTable({head:t,body:n,startY:a,margin:{left:10,right:10},styles:{fontSize:10,font:"NotoSans"},headStyles:l,bodyStyles:o,didParseCell:e=>{if(e.cell.raw.backgroundColor){const t=e.cell.raw.backgroundColor;t&&(e.cell.styles.fillColor=t)}}})}static convertTableToCsv(e,t){const n=[],l=e.fullHeaderNames.map((e=>`"${e.text.replace(/"/g,'""')}"`));return n.push(l.join(",")),e.tableBody.forEach((e=>{const l=e.map((e=>{if(!e.visible)return null;let n=e.text.replace(/"/g,'""');return t&&e.validation_color&&(n=`*${n}*`),`"${n}"`})).filter((e=>null!==e));l.length>0&&n.push(l.join(","))})),n.join("\n")}static downloadMultipleCsvFiles(e,t){return l(this,void 0,void 0,(function*(){const n=yield this.createZip();e.forEach(((e,l)=>{const o=t[l]||`table_${l+1}`;n.file(`${o}.csv`,e)})),n.generateAsync({type:"blob"}).then((e=>{const t=URL.createObjectURL(e),n=document.createElement("a");n.href=t,n.download="tables.zip",n.click(),URL.revokeObjectURL(t)}))}))}static downloadCsvFile(e,t){const n=new Blob([e],{type:"text/csv"}),l=URL.createObjectURL(n),o=document.createElement("a");o.href=l,o.download=`${t}.csv`,o.click(),URL.revokeObjectURL(l)}static parseFileName(e){return e.replace(/[\/\?<>\\:\*\|"]/g,"_")}}class a{static updateModalCheckboxStates(e,t){t.find("#downloadFilteredView").prop("checked",e.useFilter),t.find("#downloadStyledView").prop("checked",e.useStyling),t.find("#downloadValidationView").prop("checked",e.showValidations)}static updateGlobalCheckboxes(e){I.tables.length<=1?(e.find("hr").hide(),e.find("#pageDownload").parent().parent().hide()):(e.find("hr").show(),e.find("#pageDownload").parent().parent().show())}static updateModalCheckboxes(e,t){e.find("#downloadFilteredView").prop("checked",t.useFilter),e.find("#downloadStyledView").prop("checked",t.useStyling),e.find("#downloadValidationView").prop("checked",t.showValidations)}static getCheckboxStates(e){return{useFilter:e.find("#downloadFilteredView").prop("checked"),useStyling:e.find("#downloadStyledView").prop("checked"),showValidations:e.find("#downloadValidationView").prop("checked")}}static closeModal(){$("#downloadModal").modal("hide")}static updateModalCheckboxStatesGroup(e,t){t.find("#downloadFilteredView").prop("checked",e.useFilter),t.find("#downloadStyledView").prop("checked",e.useStyling),t.find("#downloadValidationView").prop("checked",e.showValidations),t.find("#downloadAsGroup").prop("checked",e.downloadAsGroup),t.find("#downloadOnlyVisible").prop("checked",e.downloadOnlyVisible)}}class r{static addDownloadModalEventListeners(e){const t=e.tableHandler.tableId.replace("table_",""),n=$("#download-"+t),l=$("#downloadModal");n.on("click",(()=>{e.tableHandler.table.hasClass("d-none")||($("#downloadModal").modal("show"),a.updateModalCheckboxStates(e,l),a.updateGlobalCheckboxes(l),this.addDownloadButtonsEventListeners(e,l),this.addDownloadOptionsEventListeners(e,l))}))}static addDownloadButtonsEventListeners(e,t){t.find(".download-buttons").off("click").on("click",(t=>{let n=$(t.target);switch(n.hasClass("btn")||(n=n.closest("button")),n.attr("id")){case"download-excel":if(I.enabled)return void I.exportAllTables("excel");e.downloadExcel();break;case"download-pdf":return I.enabled?void I.exportAllTables("pdf"):void e.downloadPdf();case"download-csv":return I.enabled?void I.exportAllTables("csv"):void e.downloadCsv()}}))}static addDownloadOptionsEventListeners(e,t){t.find(".download-options").off("change").on("change",(t=>{const n=$(t.target).attr("id");"downloadFilteredView"===n?e.useFilter=$(t.target).prop("checked"):"downloadStyledView"===n?e.useStyling=$(t.target).prop("checked"):"downloadValidationView"===n&&(e.showValidations=$(t.target).prop("checked"))})),t.find(".page-download-options").off("change").on("change",(e=>{switch($(e.target).attr("id")){case"pageDownload":const n=$(e.target).prop("checked"),l=t.find(".page-download-options #downloadSingleFile").parent().parent();n?l.removeClass("d-none"):l.addClass("d-none"),I.enabled=n;break;case"downloadSingleFile":I.oneFile=!$(e.target).prop("checked")}}))}static addGroupDownloadModalEventListeners(e,t=$("#downloadModal")){e.downloadButton.on("click",(()=>{$("#downloadModalLabel").text("Download tabellen groep"),$(".download-options").append('\n    <div class="col-md-4 group-extra-setting">\n        <div class="form-check form-switch" data-bs-toggle="tooltip" data-bs-title="Exporteer alle tabellen in één bestand, elk op een apart tabblad.">\n            <input class="form-check-input" type="checkbox" id="downloadAsGroup" name="group-extra-setting" value="filtered" checked="">\n            <label class="form-check-label" for="downloadAsGroup">Als groep</label>\n        </div>\n    </div>\n    <div class="col-md-4 group-extra-setting">\n        <div class="form-check form-switch" data-bs-toggle="tooltip" data-bs-title="Exporteer alleen de geselecteerde / zichtbare tabel naar een bestand.">\n            <input class="form-check-input" type="checkbox" id="downloadOnlyVisible" name="group-extra-setting" value="filtered">\n            <label class="form-check-label" for="downloadOnlyVisible">Geselecteerde</label>\n        </div>\n    </div>\n'),I.enabled&&t.find(".group-extra-setting").addClass("d-none"),[...document.querySelectorAll('.group-extra-setting div[data-bs-toggle="tooltip"]')].map((e=>new bootstrap.Tooltip(e,{trigger:"hover"}))),t.modal("show"),a.updateModalCheckboxStatesGroup(e,t),a.updateGlobalCheckboxes(t),this.addDownloadGroupButtonsEventListeners(e,t),this.addDownloadOptionsEventListeners(e,t),this.addDownloadGroupOptionsEventListeners(e,t);const n=t.find("#pageDownload");n.on("change",(e=>{$(e.target).prop("checked")?t.find(".group-extra-setting").addClass("d-none"):t.find(".group-extra-setting").removeClass("d-none")})),t.on("hidden.bs.modal",(function(e){$("#downloadModalLabel").text("Download tabel"),$(".group-extra-setting").remove(),n.off("change"),t.off("hidden.bs.modal")}))}))}static addDownloadGroupButtonsEventListeners(e,t){t.find(".download-buttons").off("click").on("click",(t=>{let n=$(t.target);switch(n.hasClass("btn")||(n=n.closest("button")),n.attr("id")){case"download-excel":if(I.enabled)return void I.exportAllTables("excel");e.downloadExcel();break;case"download-pdf":if(I.enabled)return void I.exportAllTables("pdf");e.downloadPdf();break;case"download-csv":if(console.log("downloading csv group"),I.enabled)return void I.exportAllTables("csv");e.downloadCsv()}}))}static addDownloadGroupOptionsEventListeners(e,t){$(".download-options").on("change",(t=>{const n=$(t.target).attr("id");"downloadAsGroup"===n?e.downloadAsGroup=$(t.target).prop("checked"):"downloadOnlyVisible"===n&&(e.downloadOnlyVisible=$(t.target).prop("checked"))}))}}var d=function(e,t,n,l){return new(n||(n=Promise))((function(o,a){function i(e){try{r(l.next(e))}catch(e){a(e)}}function s(e){try{r(l.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}r((l=l.apply(e,t||[])).next())}))};class c{constructor(e,t=!1){this.useFilter=!0,this.useStyling=!0,this.showValidations=!0,this.tableGroupHandler=null,this.tableHandler=e,t||r.addDownloadModalEventListeners(this)}prepareDownloadExcel(e){return d(this,arguments,void 0,(function*(e,t=null){this.tableHandler.readTableBody();const n=(t=null!=t?t:yield o.createWorkbook()).getWorksheet(this.tableHandler.tableName),l=t.addWorksheet(this.tableHandler.tableName+(n?` (${this.tableHandler.tableId})`:"")),a=this.tableHandler.tableHeaders;o.addHeaderRow(l,a,this.useStyling,this.tableHandler.fullHeaderNames);const i=this.tableHandler.tableBody;return o.addBodyRows(l,i,a.length,this.useFilter,this.useStyling,this.showValidations),o.autoSizeColumns(l),t}))}downloadExcel(){return d(this,arguments,void 0,(function*(e=null){e&&(this.tableHandler=e);const t=yield this.prepareDownloadExcel(this.tableHandler);yield o.executeDownload(t,this.tableHandler.tableName),a.closeModal()}))}downloadPdf(){return d(this,arguments,void 0,(function*(e=null){e&&(this.tableHandler=e),this.tableHandler.readTableBody(),o.generatePdf(this),a.closeModal()}))}downloadCsv(e=null){e&&(this.tableHandler=e),this.tableHandler.readTableBody();const t=o.convertTableToCsv(this.tableHandler,this.useFilter);o.downloadCsvFile(t,this.tableHandler.tableName),a.closeModal()}}class u{static openModal(e,t=null){e.filterModal.attr("data-active-table",e.tableId),null!==t&&this.handleClickedColumn(e,t),this.populateExistingFilters(e),this.populateFilterOptions(e,t),h.addAddNewFilterEventHandler(e),h.addChangeFilterTypeEventHandler(null,e),h.addChangeFilterColumnEventHandler(e),h.addCloseModalEventHandler(e),h.addClearFiltersEventHandler(e),h.addOnEnterEventHandler(e),this.showHideNoFiltersMessage(e),this.showHideDeleteFilterButton(e),e.filterModal.modal("show")}static handleClickedColumn(e,t){const n=e.tableHandler.fullHeaderNames.find((e=>e.columnIndex===t));e.filterModal.find(".modal-title").text(`Filter op ${n.text}`);const l=e.filterModal.find("#add-filter-card");this.updateLayoutClickedColumn(l)}static updateLayoutClickedColumn(e){e.find(".row div").first().hide();const t=e.find(".row .col-sm-4").slice(1);e.find(".row .col-sm-2").removeClass("col-sm2").addClass("col-sm-4"),t.removeClass("col-sm-4").addClass("col-sm-8")}static resetClickedColumn(e){e.filterModal.find(".modal-title").text("Filter op kolom"),e.filterModal.find("#add-filter-card .row div").first().show();const t=e.filterModal.find("#add-filter-card .row .col-sm-8");e.filterModal.find("#add-filter-card .row .col-sm-4").slice(1).removeClass("col-sm-4").addClass("col-sm-2"),t.removeClass("col-sm-8").addClass("col-sm-4")}static populateFilterOptions(e,t=null){const n=$("#filter-column");if(n.find("option").not(":first").remove(),0!==e.tableHandler.fullHeaderNames.length)for(let l=0;l<e.tableHandler.fullHeaderNames.length;l++){const o=$("<option></option>");if(o.val(e.tableHandler.fullHeaderNames[l].columnIndex),o.text(e.tableHandler.fullHeaderNames[l].text),t===e.tableHandler.fullHeaderNames[l].columnIndex){o.prop("selected",!0),o.val(t);const n=$("#add-filter-card");this.updateFilterType(n,e,t),this.fillDataList(n,e,t)}n.append(o)}}static populateExistingFilters(e){let t=e.activeFilters;e.filteringOnColumn&&(t=t.filter((t=>t.column.columnIndex===e.filterColumnIndex))),t.forEach((t=>{this.appendFilterHTML(e,t,!0)}))}static appendFilterHTML(e,t,n=!1){var l,o,a,i;console.log(t),this.filterContainer=$("#filter-container");const s=$('\n    <div class="card shadow-sm mb-2" data-bd-index="">\n    <div class="card-body p-2">\n                            <div class="row align-items-center">\n                                <div class="col-6 col-sm-4">\n                                    <h6 class="text-muted p-0 m-0 column-name"></h6>\n                                </div>\n                                <div class="col-6 col-sm-3">\n                                 <div class="firefox-fix">\n                                    <select class="form-select form-select-sm form-select-primary filter-type" aria-label="Default select example">\n                                        <option value="1">Bevat</option>\n                                        <option value="5">gelijk aan</option>\n                                        <option value="2">Getal tussen</option>\n                                        <option value="3">Groter dan</option>\n                                        <option value="4">Kleiner dan</option>\n                                    </select>\n                                    </div>\n                                </div>\n                                \n                                <div class="col-10 col-sm-4 text-field d-none mt-2 mt-sm-0">\n                                    <input type="text" class="form-control form-control-sm text-input" placeholder="Filter waarde" autocomplete="off">\n                                    <datalist class="data-list"></datalist>\n                                </div>\n                                <div class="col-10 col-sm-4 equal-field d-none mt-2 mt-sm-0">\n                                    <select class="form-select form-select-sm equal-input"\n                                            aria-label="Default select example">\n                                        <option value="" selected="">Kies waarde</option>\n                                    </select>\n                                </div>\n                                <div class="col-10 col-sm-4 d-none mt-2 mt-sm-0 more-field">\n                                    <input type="number" class="form-control form-control-sm more-input" placeholder="Groter dan">\n                                </div>\n                                <div class="col-10 col-sm-4 d-none mt-2 mt-sm-0 less-field">\n                                    <input type="number" class="form-control form-control-sm less-input" placeholder="Kleiner dan">\n                                </div>\n                                <div class="col-5 col-sm-2 min-field range-input d-none mt-2 mt-sm-0">\n                                    <input type="number" class="form-control form-control-sm min-input" placeholder="Min">\n                                </div>\n                                <div class="col-5 col-sm-2 max-field d-none range-input mt-2 mt-sm-0">\n                                    <input type="number" class="form-control form-control-sm max-input" placeholder="Max">\n                                </div>\n                                <div class="col-2 col-sm-1 d-flex justify-content-end mt-2 mt-sm-0">\n                                    <button class="btn btn-clear text-danger btn-sm d-flex  justify-content-center align-items-center remove-filter" title="Verwijder filter" style="width: 31px; height: 31px; font-size: 31px">\n                                        <i class="bi bi-x"></i>\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n</div>'),r=s.find(".column-name");r.text(t.column.text),e.filteringOnColumn&&(r.hide(),this.updateLayoutClickedColumn(s)),s.attr("data-bd-index",t.index),this.setFilterType(t.filter,s),this.setInputValue(s.find(".filter-type"),t.filter),this.setInputValue(s.find(".text-input"),t.textFilter),this.setInputValue(s.find(".min-input"),null===(null===(l=t.rangeFilter)||void 0===l?void 0:l.min)?"":null===(o=t.rangeFilter)||void 0===o?void 0:o.min),this.setInputValue(s.find(".max-input"),null===(null===(a=t.rangeFilter)||void 0===a?void 0:a.max)?"":null===(i=t.rangeFilter)||void 0===i?void 0:i.max),this.setInputValue(s.find(".less-input"),null===t.lessThan?"":t.lessThan),this.setInputValue(s.find(".more-input"),null===t.moreThan?"":t.moreThan),this.fillDataList(s,e,t.column.columnIndex),this.setInputValue(s.find(".equal-input"),t.equalTo),h.addCardEventListeners(s,e),this.updateFilterType(s,e,t.column.columnIndex),this.filterContainer.append(s);const d=e.tableHandler.fullHeaderNames.find((e=>e.columnIndex===t.column.columnIndex));this.resetAddFilterModal(d,n),this.showHideNoFiltersMessage(e),this.showHideDeleteFilterButton(e)}static resetErrorState(...e){e.forEach((e=>{e.removeClass("is-invalid"),e.parent().parent().find(".invalid-feedback").hide()}))}static markInvalid(e){e.addClass("is-invalid"),e.parent().parent().find(".invalid-feedback").show()}static setInputValue(e,t){e.is("select")&&Array.isArray(t)&&t.forEach((t=>{e.find(`option[value="${t}"]`).prop("selected",!0)})),e.val(t)}static setFilterType(e,t){const n={textInput:t.find(".text-field"),rangeInput:t.find(".range-input"),moreThan:t.find(".more-field"),lessThan:t.find(".less-field"),nullField:t.find(".null-field"),equalField:t.find(".equal-field")};switch(Object.values(n).forEach((e=>e.addClass("d-none"))),e){case 1:n.textInput.removeClass("d-none"),n.textInput.find("input").get(0).focus();break;case 2:n.rangeInput.removeClass("d-none"),n.rangeInput.find("input").get(0).focus();break;case 3:n.moreThan.removeClass("d-none"),n.moreThan.find("input").get(0).focus();break;case 4:n.lessThan.removeClass("d-none"),n.lessThan.find("input").get(0).focus();break;case 5:n.equalField.removeClass("d-none"),n.equalField.find("select").get(0).focus();break;default:n.nullField.removeClass("d-none")}}static showHideNoFiltersMessage(e){const t=$("#no-filter-card");let n=e.activeFilters;e.filteringOnColumn&&(n=n.filter((t=>t.column.columnIndex===e.filterColumnIndex))),n.length>0?t.addClass("d-none"):t.removeClass("d-none")}static resetAddFilterModal(e,t=!1){const n=$("#add-filter-card");if(n.find("input").val(""),n.find(".text-field").addClass("d-none"),n.find(".range-input").addClass("d-none"),n.find(".filter-type option").show(),t)return n.find("select").prop("selectedIndex",0),void u.setFilterType(0,n);"text"===e.columnType?(n.find(".filter-type").val("1"),this.setFilterType(1,n)):(n.find(".filter-type").prop("selectedIndex",0),u.setFilterType(0,n))}static show_table_row_count(e){const t=e.activeFilters.length,n=e.tableHandler.tableBody.length,l=e.shown_rows;let o;if(o=e.hasCustomFilter?$(`.table-group-row-count-${e.customFilterId}`):$(`.table-row-count-${e.tableId}`),0!==t){if(0===l)return o.removeClass("d-none"),void o.text(`Geen resultaten in de ${n} rijen`);o.removeClass("d-none"),o.text(`${l} van de ${n} rijen`)}else o.text(`${n} rijen`)}static show_table_filter_count(e){const t=e.activeFilters.length;let n=$(`.table-filter-count-${e.tableId}`);e.hasCustomFilter&&(n=$(`.table-group-filter-count-${e.customFilterId}`)),0!==t?(n.removeClass("d-none"),n.find("p").text(t.toString())):n.addClass("d-none")}static updateFilterType(e,t,n=0){const l=t.tableHandler.fullHeaderNames.find((e=>e.columnIndex===n));if(!l)return;const o=e.find(".filter-type");switch(o.find("option").show(),l.columnType){case"text":o.find('option[value="2"]').hide(),o.find('option[value="3"]').hide(),o.find('option[value="4"]').hide();break;case"number":o.find('option[value="1"]').hide();break;default:o.find("option").show()}}static clearFilters(e){const t=this.filterContainer.find(".card").not("#no-filter-card");let n=e.activeFilters;if(e.filteringOnColumn)return n=n.filter((t=>t.column.columnIndex==e.filterColumnIndex)),n.forEach((e=>{this.filterContainer.find(`.card[data-bd-index="${e.index}"]`).remove()})),e.activeFilters=e.activeFilters.filter((t=>t.column.columnIndex!==e.filterColumnIndex)),this.showHideNoFiltersMessage(e),this.showHideDeleteFilterButton(e),void this.applyFilterIndication(e);t.remove(),e.activeFilters=[],this.showHideNoFiltersMessage(e),this.showHideDeleteFilterButton(e),this.applyFilterIndication(e)}static showHideDeleteFilterButton(e){let t=$("#clear-filters"),n=e.activeFilters;e.filteringOnColumn&&(n=n.filter((t=>t.column.columnIndex===e.filterColumnIndex))),n.length>1?t.removeClass("d-none"):t.addClass("d-none")}static fillDataList(e,t,n){const l=e.find(".text-field .data-list"),o=e.find(".equal-input"),a=t.tableHandler.tableBody.map((e=>e[n]?e[n].text.toLowerCase():null)),i=Math.floor(1e6*Math.random()),s=[...new Set(a)];l.empty(),o.empty(),o.append($('<option value="" selected disabled>Kies een waarde</option>')),s.forEach((e=>{const t=$("<option></option>");t.val(e),t.text(e),l.append(t),o.append(t.clone())})),l.attr("id",`data-list-${i}`),e.find(".text-input").attr("list",`data-list-${i}`)}static applyFilterIndication(e){const t=e.activeFilters,n=[...new Set(t.map((e=>e.column.columnIndex)).filter((e=>null!==e)))],l=e.tableHandler.table;l.find("thead th .has-filter").remove(),l.find("thead th .table-header").removeClass("position-relative"),n.forEach((e=>{const t=$('<span class="has-filter position-absolute" style="top: -5px; right: -5px">\n                                <i class="bi bi-funnel-fill" style="font-size: 10px"></i>\n                            </span>');l.find(`thead th[data-column-index="${e}"] .table-header`).addClass("position-relative"),l.find(`thead th[data-column-index="${e}"] .table-header`).append(t)}))}}u.filterContainer=$("#filter-container");class h{static addOpenModalEventHandler(e,t=null){let n=$("#filter-table-"+e.tableId);e.hasCustomFilter&&(n=t),0!==n.length&&(n.on("click",(()=>{e.hasCustomFilter&&e.tableHandler.table.parent().hasClass("d-none")||(e.filteringOnColumn=!1,e.filterColumnIndex=null,u.openModal(e))})),e.tableHandler.table.find("div.table-header-text").on("click",(t=>{const n=$(t.target).closest("th").data("column-index");void 0!==n&&(e.filteringOnColumn=!0,e.filterColumnIndex=n,u.openModal(e,n))})))}static addOnEnterEventHandler(e){e.filterModal.find("#add-filter-card input").off("keydown").on("keydown",(e=>{"Enter"===e.key&&$(e.target).closest(".card").find("#add-filter").trigger("click")}))}static addAddNewFilterEventHandler(e){$("#add-filter").on("click",(t=>{e.addNewFilter(t)}))}static addChangeFilterTypeEventHandler(e=null,t){e?e.find(".filter-type").on("change",(n=>{const l=+$(n.target).val(),o=+e.attr("data-bd-index"),a=t.activeFilters.find((e=>e.index===o));!a||1!==l&&2!==l&&3!==l&&4!==l||(a.filter=l),u.setFilterType(l,e),t.filter()})):$(".filter-type").on("change",(e=>{const t=+$(e.target).val(),n=$(e.target).closest(".card");u.setFilterType(t,n)}))}static addCloseModalEventHandler(e){e.filterModal.on("hidden.bs.modal",(()=>{e.filterModal.attr("data-active-table",""),e.filterModal.off("hidden.bs.modal"),u.filterContainer.find(".card").not("#no-filter-card").remove(),e.filteringOnColumn&&u.resetClickedColumn(e),$("#add-filter").off("click"),$("#clear-filters").off("click"),$("#filter-column").off("change"),$(".filter-type").off("change")}))}static addCardEventListeners(e,t){this.addRemoveFilterEventHandler(e,t),this.addChangeFilterTypeEventHandler(e,t),this.addOnInputEventHandler(e,t)}static addRemoveFilterEventHandler(e,t){e.find(".remove-filter").on("click",(e=>{t.deleteFilter(e)}))}static addOnInputEventHandler(e,t){const n=(n,l)=>{e.find(n).on("input change",(n=>{const o=n.target,a=+e.attr("data-bd-index"),i=t.activeFilters.find((e=>e.index===a));i&&l(i,o.value),t.filter()}))};n(".min-input",((e,t)=>e.rangeFilter.min=+t)),n(".max-input",((e,t)=>e.rangeFilter.max=+t)),n(".text-input",((e,t)=>e.textFilter=t)),n(".more-input",((e,t)=>e.moreThan=+t)),n(".less-input",((e,t)=>e.lessThan=+t)),n(".equal-input",((t,n)=>{t.equalTo=e.find(".equal-input").val()}))}static addChangeFilterColumnEventHandler(e){$("#filter-column").on("change",(t=>{const n=$(t.target).closest(".card"),l=+$(t.target).val();u.updateFilterType(n,e,l),u.fillDataList(n,e,l),e.filter()}))}static addClearFiltersEventHandler(e){$("#clear-filters").on("click",(()=>{e.clearFilters()}))}}class p{constructor(e=null,t=null){this.min=e,this.max=t}}class f{constructor(e,t,n,l,o=null,a=null,i=new p,s=null){this.index=e,this.column=t,this.filter=n,this.textFilter=l,this.moreThan=o,this.lessThan=a,this.rangeFilter=i,this.equalTo=s}}class b{static createFilter(e,t,n,l,o,a,i,s,r){const d=r.indexCounter++;switch(t){case 1:return new f(d,e,t,n);case 2:return new f(d,e,t,null,null,null,new p(l,o));case 3:return new f(d,e,t,null,a);case 4:return new f(d,e,t,null,null,i);case 5:return new f(d,e,t,null,null,null,new p,s);default:return null}}static validateColumn(e,t){return t.tableHandler.fullHeaderNames.find((t=>t.columnIndex===e))}static getFilterInputs(e){const t=e=>{if(null==e||""===e.trim())return null;const t=Number(e);return isNaN(t)?null:t};return{columnValue:+e.find("#filter-column").val(),filterValue:+e.find(".filter-type").val(),textFilter:e.find(".text-input").val()||null,minRange:t(e.find(".min-input").val()),maxRange:t(e.find(".max-input").val()),moreThan:t(e.find(".more-input").val()),lessThan:t(e.find(".less-input").val()),equal:e.find(".equal-input").val()}}}class m{constructor(e,t=null,n=null){if(this.filterModal=$("#filterModal"),this.activeFilters=[],this.shown_rows=0,this.indexCounter=0,this.hasCustomFilter=!1,this.customFilterId=null,this.filteringOnColumn=!1,this.filterColumnIndex=null,this.filter=()=>{this.shown_rows=0;const e=this,t=this.activeFilters;this.tableHandler.table.find("tbody tr").each((function(){const n=$(this);let l=!0;t.forEach((e=>{var t;const o=e.filter,a=e.rangeFilter,i=null===(t=e.textFilter)||void 0===t?void 0:t.toLowerCase(),s=e.lessThan,r=e.moreThan,d=e.equalTo,c=n.find(`td:eq(${e.column.columnIndex})`).text().toLowerCase();switch(o){case 1:c.includes(i)||""===i||void 0===i||(l=!1);break;case 2:null!==a.min&&null!==a.max&&(+c<a.min||+c>a.max)&&(l=!1);break;case 3:+c<r&&null!==r&&(l=!1);break;case 4:+c>s&&null!==s&&(l=!1);break;case 5:d&&d.length>0&&""!==d[0]&&d!==c&&(l=!1);break;default:return}})),l?(e.shown_rows++,n.show()):n.hide()})),u.show_table_row_count(this),u.show_table_filter_count(this)},0===this.filterModal.length)throw new Error("Filter modal not found");this.tableHandler=e,this.tableId=e.tableId.replace("table_",""),this.hasCustomFilter=t&&t.length>0,this.customFilterId=n,h.addOpenModalEventHandler(this,t),u.show_table_row_count(this)}addNewFilter(e){const t=$(e.target).closest(".card"),n=b.getFilterInputs(t),{columnValue:l,filterValue:o,textFilter:a,minRange:i,maxRange:s,moreThan:r,lessThan:d,equal:c}=n;u.resetErrorState(t.find("#filter-column"),t.find(".filter-type"));const h=b.validateColumn(l,this),p=!!h;p||u.markInvalid(t.find("#filter-column"));const f=b.createFilter(h,o,a,i,s,r,d,c,this),m=!!f;return m||u.markInvalid(t.find(".filter-type")),!(!p||!m||(this.activeFilters.push(f),u.appendFilterHTML(this,f),u.applyFilterIndication(this),this.filter(),0))}deleteFilter(e){const t=$(e.target).closest(".card"),n=this.activeFilters.findIndex((e=>e.index===+t.attr("data-bd-index")));this.activeFilters.splice(n,1),t.remove(),u.showHideNoFiltersMessage(this),u.showHideDeleteFilterButton(this),u.applyFilterIndication(this),this.filter()}clearFilters(){u.clearFilters(this),this.filter()}}class v{constructor(t,n,l=!1){this.tableDownload=null,this.fullHeaderNames=[],this.tableHeaders=[],this.tableBody=[],this.collapsed=!1,this.table=t,this.tableId=n,this.setTableId(),this.setTableName(),this.readTable(),this.tableSorter=new e(this.table,this.tableId),l||(this.tableFilter=new m(this),this.tableDownload=new c(this),this.addExpandCollapse()),this.handleRotedHeaders()}setTableId(){this.table.attr("id",this.tableId)}readTable(){this.readTableHeader(),this.readTableBody()}readTableHeader(){const e=this.table.find("thead"),n=this.table.find("tbody");let l=0;e.find("tr").each(((e,o)=>{const a=[];let i=0;$(o).find("th").each(((e,o)=>{const s=$(o).attr("colspan"),r=$(o).text().trim();if(s){const e=Array.from({length:parseInt(s)},(()=>i++));for(let o=0;o<parseInt(s);o++){const d=i-parseInt(s)+o,c=n.find("tr:eq(0)").find(`td:eq(${d})`).text().trim().replace(",","."),u=Number(c),h=isNaN(u)?"text":"number",p=this.updateFullHeaderNames(d,r,h);o>0?a.push(new t("",0,e,l++,p)):a.push(new t(r,parseInt(s),e,l++,p))}}else a.push(new t(r,1,[i++],l++,this.updateFullHeaderNames(i-1,r)))})),this.tableHeaders.push(a)}))}readTableBody(){this.tableBody=[],this.table.find("tbody").find("tr").each(((e,t)=>{const l="none"!==$(t).css("display"),o=[];$(t).find("td").each(((e,t)=>{var a,i,s;const r=null===(s=null===(i=null===(a=$(t).attr("style"))||void 0===a?void 0:a.split("background-color:")[1])||void 0===i?void 0:i.split(";")[0])||void 0===s?void 0:s.trim(),d=$(t).find(".table-body-text p"),c=d.length>0?d.text().trim():$(t).text().trim(),u=$(t).find("a").attr("href")||null;r&&"None"!==r?o.push(new n(c,this.getHexColor(r),this.getRgbColor(r),l,u)):o.push(new n(c,null,null,l,u))})),this.tableBody.push(o)}))}updateFullHeaderNames(e,t,n="text"){const l=this.fullHeaderNames.find((t=>t.columnIndex===e));return l?(l.text+=` ${t}`,l.text=l.text.trim(),l.text):(this.fullHeaderNames.push({columnIndex:e,text:t,columnType:n}),t)}getHexColor(e){if(/^#[0-9A-F]{6}$/i.test(e))return e.split("#")[1];const t=$("<div></div>").css("color",e).appendTo("body"),n=t.css("color");t.remove();const l=n.match(/\d+/g);return l?`${((1<<24)+(parseInt(l[0])<<16)+(parseInt(l[1])<<8)+parseInt(l[2])).toString(16).slice(1)}`:null}getRgbColor(e){const t=$("<div></div>").css("color",e).appendTo("body"),n=t.css("color");t.remove();const l=n.match(/\d+/g);return!l||l.length<3?null:[parseInt(l[0]),parseInt(l[1]),parseInt(l[2])]}setTableName(){this.tableName=this.table.attr("data-bd-table-name")||"Table"}addExpandCollapse(){const e=$(`#expand-collaps-button-${this.tableId.replace("table_","")}`),t=this.table.parent();t.hasClass("collapse")&&(this.collapsed=!0,e.html('<i class="bi bi-caret-down-fill"></i>')),e.on("click",(()=>{switch(this.collapsed){case!0:this.collapsed=!1,e.html('<i class="bi bi-caret-up-fill"></i>'),t.removeClass("collapse");break;case!1:this.collapsed=!0,e.html('<i class="bi bi-caret-down-fill"></i>'),t.addClass("collapse")}e.tooltip("hide")}))}handleRotedHeaders(){const e=this.table.hasClass("angled-headers-45"),t=this.table.hasClass("angled-headers-90"),n=this.table.closest(".table-wrapper"),l=n.hasClass("d-none");if(l&&n.removeClass("d-none").css({visibility:"hidden",display:"block"}),e&&this.table.find("th").each(((e,t)=>{const n=$(t),l=1.5*n.find("div.table-header-text").outerHeight();n.find("span.table-header-text").css("margin-left",`${l}px`)})),t){let e=0;this.table.find("th").each(((t,n)=>{const l=$(n),o=l.find("div.table-header-text"),a=l.find(".table-header"),i=o.outerHeight(),s=o.outerWidth();a.css("width",`${s+20}px`),l.find("span.table-header-text").css("padding-left",`${i}px`),s>e&&(e=s)})),this.table.find("th").each(((t,n)=>{$(n).find(".header-wrapper").css("height",`${e}px`)}))}l&&n.addClass("d-none").css({visibility:"",display:""})}}var g=function(e,t,n,l){return new(n||(n=Promise))((function(o,a){function i(e){try{r(l.next(e))}catch(e){a(e)}}function s(e){try{r(l.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}r((l=l.apply(e,t||[])).next())}))};class w extends c{constructor(e=null,t=null){super(t.activeTable.tableHandler,!0),this.downloadAsGroup=!0,this.downloadOnlyVisible=!1,this.tableGroupHandler=t,this.downloadButton=e,r.addGroupDownloadModalEventListeners(this)}downloadExcel(){const e=Object.create(null,{downloadExcel:{get:()=>super.downloadExcel}});return g(this,void 0,void 0,(function*(){if(this.downloadOnlyVisible)yield e.downloadExcel.call(this,this.tableGroupHandler.activeTable.tableHandler);else{if(this.downloadAsGroup){let e="";const t=yield o.createWorkbook();let n=1;for(let l of this.tableGroupHandler.tables){if(!l.tableHandler)continue;l.tableHandler.readTableBody();let a=l.tableHandler.tableName||"Table";t.getWorksheet(a)&&(a=`${a} (${n})`,n++);const i=t.addWorksheet(a),s=l.tableHandler.tableHeaders,r=l.tableHandler.tableBody;o.addHeaderRow(i,s,this.useStyling,l.tableHandler.fullHeaderNames),o.addBodyRows(i,r,s.length,this.useFilter,this.useStyling,this.showValidations),o.autoSizeColumns(i),e+=`${l.tableHandler.tableName}_`}return e=e.slice(0,-1),yield o.executeDownload(t,e),void a.closeModal()}for(let t of this.tableGroupHandler.tables)yield e.downloadExcel.call(this,t.tableHandler)}}))}downloadPdf(){const e=Object.create(null,{downloadPdf:{get:()=>super.downloadPdf}});return g(this,void 0,void 0,(function*(){if(this.downloadOnlyVisible)yield e.downloadPdf.call(this,this.tableGroupHandler.activeTable.tableHandler);else{if(this.downloadAsGroup){let e="",t=!0;const n=yield o.createPdfInstance("a4");for(let l of this.tableGroupHandler.tables){if(!l.tableHandler)continue;l.tableHandler.readTableBody(),e+=`${l.tableHandler.tableName}_`;let a=20;t||n.addPage();const i=l.tableHandler.tableHeaders,s=l.tableHandler.tableBody;let r=o.getHeadStyle(this),d=o.getBodyStyle(this);const c=o.extractHeaderData(i,this),u=o.extractBodyData(s,this);o.createPdf(n,c,u,r,d,a),t=!1}return e=e.slice(0,-1),n.save(`${o.parseFileName(e)}.pdf`),void a.closeModal()}for(let t of this.tableGroupHandler.tables)yield e.downloadPdf.call(this,t.tableHandler)}}))}downloadCsv(){return g(this,void 0,void 0,(function*(){if(0===this.tableGroupHandler.tables.length)return;if(this.downloadOnlyVisible){if(!this.tableGroupHandler.activeTable.tableHandler)return;const e=o.convertTableToCsv(this.tableGroupHandler.activeTable.tableHandler,this.showValidations);return o.downloadCsvFile(e,this.tableGroupHandler.activeTable.tableHandler.tableName),void a.closeModal()}let e=[];for(let t of this.tableGroupHandler.tables)t&&t.tableHandler&&(t.tableHandler.readTableBody(),e.push(o.convertTableToCsv(t.tableHandler,this.showValidations)));yield o.downloadMultipleCsvFiles(e,this.tableGroupHandler.tables.map((e=>{var t,n;return null!==(n=null===(t=e.tableHandler)||void 0===t?void 0:t.tableName)&&void 0!==n?n:"Table"}))),a.closeModal()}))}}class y{constructor(e){this.tables=[],this.collapsed=!1,this.nonVisibleButtons=[],this.htmlTables=$(`table[data-dd-table-group="${e}"], .alert[data-dd-table-group="${e}"]`),this.id=e,this.buttonGroupId=`button-group-${e}`,this.removeOutOfBoundButtons(),this.htmlTables.each(((e,t)=>{const n=($(t).attr("id")||`table-${e}`).replace("-","_");if($(t).hasClass("alert"))return void this.tables.push({tableHandler:null,tableFilter:null,isEmpty:!0,item:$(t),tableId:n});const l=new v($(t),n,!0),o=new m(l,$(`#filter-table-group-${this.id}`),this.id);this.tables.push({tableHandler:l,tableFilter:o,isEmpty:!1,item:$(t),tableId:n})})),this.activeTable=this.tables[0],new w($(`#download-group-${this.id}`),this),$(`#${this.buttonGroupId}`).on("click",(e=>{const t=$(e.target).attr("data-dd-table-id");if(!t)return;const n=`table_${t}`;this.activeTable=this.tables.find((e=>e.tableId===n)),this.activeTable?this.toggleTable(n):console.error(`Table with ID ${n} not found in group ${this.id}`)})),this.startCollapse(),$(window).on("resize",(()=>{$(`#${this.buttonGroupId}`).is(":visible")&&this.removeOutOfBoundButtons()})),console.log(this)}toggleTable(e){const t=this.tables.find((t=>t.tableId===e));if(!t)return void console.error(`Table with ID ${e} not found in group ${this.id}`);this.tables.forEach((e=>{e.item.parent().addClass("d-none")}));const n=this.activeTable.tableFilter;n&&(u.show_table_row_count(n),u.show_table_filter_count(n)),t.item.parent().removeClass("d-none")}startCollapse(){const e=$(`#expand-collaps-group-button-${this.id}`),t=$(`#table-group-${this.id}`);t.hasClass("collapse")&&(this.collapsed=!0,e.html('<i class="bi bi-caret-down-fill"></i>')),e.on("click",(()=>{switch(this.collapsed){case!0:this.collapsed=!1,e.html('<i class="bi bi-caret-up-fill"></i>'),t.removeClass("collapse");break;case!1:this.collapsed=!0,e.html('<i class="bi bi-caret-down-fill"></i>'),t.addClass("collapse")}e.tooltip("hide")}))}getTableHandlers(){return this.tables.map((e=>e.tableHandler))}resetButtonGroup(){this.nonVisibleButtons.forEach((e=>{e.css("display","inline-block")})),$(`#${this.buttonGroupId} .dropdown-toggle`).remove(),$(`#${this.buttonGroupId} .dropdown-menu`).remove(),this.nonVisibleButtons=[]}calculateGroupBounds(){const e=$(`#${this.buttonGroupId}`),t=parseFloat(e.css("padding-left"))||0,n=parseFloat(e.css("padding-right"))||0;return{left:e.offset().left+t,right:e.offset().left+e.innerWidth()-n-50}}filterButtonsWithinBounds(e){const t=$(`#${this.buttonGroupId}`);let n=null;return t.find("label").each(((t,l)=>{const o=$(l),a=o.offset().left,i=a+o.outerWidth(!0);o.removeClass("rounded-end"),i>e.right||a<e.left?(o.css("display","none"),this.nonVisibleButtons.push(o)):(o.css("display","inline-block"),n=o)})),n}renderDropdown(){const e=$(`<button class="btn btn-sm btn-secondary dropdown-toggle" type="button" id="dropdownGroupMenuButton-${this.id}" data-bs-toggle="dropdown" aria-expanded="false">Meer</button>`),t=$(`<ul class="dropdown-menu" aria-labelledby="dropdownGroupMenuButton-${this.id}" id="dropdownGroupMenu-${this.id}"></ul>`);this.nonVisibleButtons.forEach((e=>{const n=e.attr("for"),l=$(`#${n}`).is(":checked"),o=$(`<li><a class="dropdown-item ${l?"active":""}" href="#" data-dd-table-id="${e.attr("data-dd-table-id")}">${e.text()}</a></li>`);o.on("click",(n=>{n.preventDefault(),e.trigger("click",[n]),t.removeClass("show"),t.find("a").removeClass("active"),o.find("a").addClass("active")})),t.append(o)})),$(`#${this.buttonGroupId}`).append(e).append(t)}removeOutOfBoundButtons(){if(this.resetButtonGroup(),0===$(`#${this.buttonGroupId}`).length)return;const e=this.calculateGroupBounds(),t=this.filterButtonsWithinBounds(e);if(1===this.nonVisibleButtons.length&&t)return this.nonVisibleButtons[0].css("display","inline-block"),void(this.nonVisibleButtons=[]);this.nonVisibleButtons.length>0&&this.renderDropdown()}}var x=i(4213),C=function(e,t,n,l){return new(n||(n=Promise))((function(o,a){function i(e){try{r(l.next(e))}catch(e){a(e)}}function s(e){try{r(l.throw(e))}catch(e){a(e)}}function r(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,s)}r((l=l.apply(e,t||[])).next())}))};class F{constructor(e){this.activeComponent=null,this.componentControls=null,this.nonVisibleButtons=[],this.buttonGroup=null,this.groupId=e,this.init()}init(){this.components=$(`.component-group[data-dd-group="${this.groupId}"] [data-dd-group][data-dd-group-index]`).toArray().map((e=>$(e))),this.activeComponent=this.components[0],this.componentControls=$(`.component-group[data-dd-group="${this.groupId}"] > .component-header > .component-controls`),this.buttonGroup=this.componentControls.find(".btn-group"),this.buttonGroup&&this.buttonGroup.length>0?this.removeOutOfBoundButtons():console.warn(`No button group found for component group with ID: ${this.groupId}`),this.identifyControls(),this.bindEvents()}identifyControls(){if(!this.componentControls||0===this.componentControls.length)return void console.warn(`No component controls found for group: ${this.groupId}`);let e=Math.random().toString(36).substring(2,15);this.componentControls.find('input[type="radio"], label').each(((t,n)=>{const l=$(n);l.is('input[type="radio"]')?(e=Math.random().toString(36).substring(2,15),l.attr("id",`dd-group-${this.groupId}-${e}`),l.attr("name",`dd-btn-group-${this.groupId}`)):l.is("label")&&l.attr("for",`dd-group-${this.groupId}-${e}`)}))}bindEvents(){this.componentControls&&0!==this.componentControls.length?(this.componentControls.on("change",(e=>{const t=$(e.target);if(t.is('input[type="radio"]')){const e=parseInt(t.data("dd-group-index"),10);!isNaN(e)&&e>=0&&e<this.components.length?this.selectComponent(e):console.warn(`Invalid index: ${e}`)}})),$(window).on("resize",(()=>{this.buttonGroup&&this.buttonGroup.is(":visible")&&this.removeOutOfBoundButtons()}))):console.warn(`No component controls found for group: ${this.groupId}`)}selectComponent(e){this.activeComponent&&this.activeComponent.addClass("d-none"),this.activeComponent=this.components[e],this.activeComponent.removeClass("d-none"),window.dispatchEvent(new Event("resize"))}resetButtonGroup(){this.buttonGroup?(this.nonVisibleButtons.forEach((e=>{e.css("display","inline-block")})),this.buttonGroup.find(".dropdown-toggle").remove(),this.buttonGroup.find(".dropdown-menu").remove(),this.nonVisibleButtons=[]):console.warn(`No button group found for component group with ID: ${this.groupId}`)}calculateGroupBounds(){const e=this.buttonGroup,t=parseFloat(e.css("padding-left"))||0,n=parseFloat(e.css("padding-right"))||0;return{left:e.offset().left+t,right:e.offset().left+e.innerWidth()-n-70}}filterButtonsWithinBounds(e){const t=this.buttonGroup;let n=null;return t.find("label").each(((t,l)=>{const o=$(l),a=o.offset().left,i=a+o.outerWidth(!0);o.removeClass("rounded-end"),i>e.right||a<e.left?(o.css("display","none"),this.nonVisibleButtons.push(o)):(o.css("display","inline-block"),n=o)})),n}renderDropdown(){const e=$(`<button class="btn btn-sm btn-secondary dropdown-toggle" type="button" id="dropdownGroupMenuButton-${this.groupId}" data-bs-toggle="dropdown" aria-expanded="false">Meer</button>`),t=$(`<ul class="dropdown-menu" aria-labelledby="dropdownGroupMenuButton-${this.groupId}" id="dropdownGroupMenu-${this.groupId}"></ul>`);this.nonVisibleButtons.forEach((e=>{const n=e.attr("for"),l=$(`#${n}`).is(":checked"),o=$(`<li><a class="dropdown-item ${l?"active":""}" href="#" data-dd-group-index="${e.data("dd-group-index")}">${e.text()}</a></li>`);o.on("click",(n=>{n.preventDefault(),e.trigger("click",[n]),t.removeClass("show"),t.find("a").removeClass("active"),o.find("a").addClass("active")})),t.append(o)})),this.buttonGroup.append(e).append(t)}removeOutOfBoundButtons(){if(this.resetButtonGroup(),!this.buttonGroup)return void console.warn(`No button group found for component group with ID: ${this.groupId}`);const e=this.calculateGroupBounds(),t=this.filterButtonsWithinBounds(e);if(1===this.nonVisibleButtons.length&&t)return this.nonVisibleButtons[0].css("display","inline-block"),void(this.nonVisibleButtons=[]);this.nonVisibleButtons.length>0&&this.renderDropdown()}}$("body");const k=[];let H=[];$("table, .alert").each(((e,t)=>{const n=$(t).attr("data-dd-table-group");if(!n&&t.classList.contains("alert"))return;let l=$(t).attr("id");const o=+l.replace("table-","");if(l="table_"+o,n&&!k.includes(n)){k.push(n);const e=new y(n);H=H.concat(e.getTableHandlers())}else k.includes(n)||H.push(new v($(t),l))})),$(".component-group").each(((e,t)=>{const n=$(t).attr("data-dd-group");n&&new F(n)})),new class{constructor(){this.tableContainers=$(".table-container"),this.addScrollingHeaderListener()}addScrollingHeaderListener(){const e=this;this.tableContainers.each((function(){const t=$(this),n=t.find("table").find("thead");e.applyEventListener(n,t)}))}applyEventListener(e,t){let n=!1;const l=()=>{n||(window.requestAnimationFrame((()=>{this.scroll(e,t),n=!1})),n=!0)};$(window).on("scroll",l),$(t).on("scroll",l),$(".flex-grow-1.overflow-x-hidden").on("scroll",l)}scroll(e,t){const n=t.offset().top,l=t.height(),o=e.height(),a=t.scrollTop(),i=window.scrollY,s=n+l<i+o,r=n<i,d=a>0;if(!r&&!d&&!s)return void e.css("transform","none");let c=0;r&&!s?c=i-n+a:d&&!s?c=a:s&&(c=l-o+parseInt(e.css("border-bottom-width")||"0")),c=Math.round(c),e.css("transform",`translateY(${c}px)`)}},$(".hover").on("mouseenter",(function(){$(".hover-element").length>0&&$(".hover-element").remove();const e=300,t=$(this),n=t.find(".details"),l=t.offset();let o=20,a=20;const i=$('<div class="hover-element"></div>');i.append(n.clone()),i.css({zIndex:1e3,display:"none",position:"absolute",witespace:"wrap",overflow:"hidden",maxWidth:"300px",padding:"1rem",fontSize:"1rem"}),$("body").append(i),l.left+i.width()>t.closest(".table-container").width()-40&&(o=-i.width()-o-10),l.top+i.height()>$(window).height()-60&&(a=-i.height()-a-10),i.css({left:l.left+o,top:l.top+a}),$("body").append(i),i.fadeIn(e),t.on("mouseleave",(function(){i.fadeOut(e,(function(){$(this).remove()}))})),i.on("mouseenter",(function(){i.stop(),i.fadeIn(e),i.on("mouseleave",(function(){i.fadeOut(e,(function(){$(this).remove()}))}))}))}));const I=new class{constructor(e=[]){this.enabled=!1,this.oneFile=!0,this.useFilter=!0,this.useStyling=!0,this.showValidations=!0,this.tables=e}exportAllTables(){return C(this,arguments,void 0,(function*(e="excel"){const t=yield o.createZip(),n=this.oneFile&&"excel"===e,l=n?yield o.createWorkbook():void 0,i=yield o.createPdfInstance("a4");let s=!0;for(const n of this.tables)s||"pdf"!==e||i.addPage(),yield this.exportSingleTable(n,e,t,i,l),s=!1;if(n&&l&&"excel"===e)o.executeDownload(l,"all_tables");else if(this.oneFile&&"pdf"===e)i.save("all_tables.pdf");else{const e=yield t.generateAsync({type:"blob"}),n="all_tables.zip";(0,x.saveAs)(e,n)}a.closeModal()}))}exportSingleTable(e,t,n,l,a){return C(this,void 0,void 0,(function*(){var i;const s=null!==(i=e.tableDownload)&&void 0!==i?i:new c(e,!0),r={useStyling:s.useStyling,showValidations:s.showValidations,useFilter:s.useFilter};if(this.applySettings(s),a&&"excel"===t)s.prepareDownloadExcel(e,a);else if("pdf"===t)o.generatePdfFile(s,l);else if("csv"===t){const l=o.convertTableToCsv(e,this.useFilter),a=this.generateFileName(e,n,t);n.file(a,l)}else{const l=yield this.generateBufferForFormat(s,e,t),o=this.generateFileName(e,n,t);n.file(o,l)}this.resetSettings(s,r)}))}generateBufferForFormat(e,t,n){return C(this,void 0,void 0,(function*(){if("excel"===n){const n=yield o.createWorkbook();return e.prepareDownloadExcel(t,n),yield n.xlsx.writeBuffer()}if("pdf"===n){const t=yield o.generatePdfFile(e),n=yield t.output("blob");return yield n.arrayBuffer()}throw new Error(`Unsupported export format: ${n}`)}))}generateFileName(e,t,n){const l="excel"===n?"xlsx":"pdf"===n?"pdf":"csv";let o=`${e.tableName}.${l}`;return t.file(o)&&(o=`${e.tableName} (${e.tableId}).${l}`),o}applySettings(e){e.useStyling=this.useStyling,e.showValidations=this.showValidations,e.useFilter=this.useFilter}resetSettings(e,t){e.useStyling=t.useStyling,e.showValidations=t.showValidations,e.useFilter=t.useFilter}}(H);document.addEventListener("DOMContentLoaded",(function(){window.dispatchEvent(new Event("resize")),[...document.querySelectorAll('[data-bs-toggle="tooltip"]')].map((e=>new bootstrap.Tooltip(e,{trigger:"hover",container:"body"})))}));const T=$(".sidebar-wrapper");T.length>0&&new class{constructor(e){this.element=e,this.applyEventListeners()}applyEventListeners(){this.applyEventSidebarExpandCollapse(),this.applyEventSidebarOnClick()}applyEventSidebarExpandCollapse(){this.element.find(".sidebar-toggle").on("click",(e=>{this.element.toggleClass("collapsed"),this.changeSidebarState(),$('.nav-group [data-bs-toggle="tooltip"]').each(((e,t)=>{this.element.hasClass("collapsed")?this.showTooltip(t):this.hideTooltip(t)})),window.dispatchEvent(new Event("resize"))}))}applyEventSidebarOnClick(){this.element.find(".sidebar").on("click",(e=>{const t=$(e.target).closest(".nav-group");if(t.hasClass("sidebar-show-all"))this.handleShowAllClick(t);else if(t.length>0){const e=t.data("dd-target");if($(".component-wrapper").addClass("d-none"),e){const t=$(`#${e}`);t.length>0?(t.removeClass("d-none"),$(window).trigger("resize")):console.warn(`Target component with ID ${e} not found.`)}else console.warn("No target ID specified for the clicked nav link.");$(".nav-group").removeClass("active"),t.addClass("active")}}))}showTooltip(e){let t=bootstrap.Tooltip.getInstance(e);t||(t=new bootstrap.Tooltip(e,{trigger:"hover",container:"body"})),t.enable()}hideTooltip(e){let t=bootstrap.Tooltip.getInstance(e);t?(t.disable(),t.hide()):console.warn("No tooltip instance found for",e)}changeSidebarState(){const e=this.element.find(".sidebar-toggle i");this.element.hasClass("collapsed")?e.removeClass("bi-chevron-double-left").addClass("bi-chevron-double-right"):e.removeClass("bi-chevron-double-right").addClass("bi-chevron-double-left")}handleShowAllClick(e){$(".component-wrapper").removeClass("d-none"),$(".nav-group").removeClass("active"),e.addClass("active")}}(T)})()})();